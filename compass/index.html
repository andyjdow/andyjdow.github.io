<head>
  <title>Compass</title>

  <style type="text/css">
    
    /* Positioning:
       "absolute" position set an elements position within the next parent element with "relative" position. 
       "relative" position mean it can be position relative to itself as placed in document order */
    #compass {
      position: relative;
    }
    #rose {
      /* The "vh" (viewpoert height) & "vw" (viewport width) were the only things I could get to work to correctly scale the image
         o  https://stackoverflow.com/questions/27612931/styling-html-and-body-selector-to-height-100-vs-using-100vh */
      position: absolute;
      top: 0;
      left: 0;
      height: 90vh;
      width: 100vw;
      z-index: 0;
    }
    #needle {
      position: absolute;
      top: 0;
      left: 0;
      height: 90vh;
      width: 100vw;
      z-index: 1;
    }
  </style>

</head>
<body>
  <div id="disp">Heading will display here</div>
  <div id="compass">
    <svg id="rose" version="1.1" viewBox="0 0 80.465 80.465"xmlns="http://www.w3.org/2000/svg"xmlns:cc="http://creativecommons.org/ns#"xmlns:dc="http://purl.org/dc/elements/1.1/"xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
      <metadata>
        <rdf:RDF>
          <cc:Work rdf:about="">
            <dc:format>image/svg+xml</dc:format>
            <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/>
            <dc:title/>
          </cc:Work>
        </rdf:RDF>
      </metadata>
      <g transform="translate(.2325 .2325)">
        <g fill="none" stroke="#000" stroke-width=".26458px">
          <path d="m0 40h3"/>
          <path d="m80 40h-3"/>
          <path d="m40 0v3"/>
          <path d="m40 80v-3"/>
        </g>
        <circle cx="40" cy="40" r="40" fill="none" stroke="#000" stroke-width=".465"/>
        <g transform="rotate(80 40 40)" fill="none" stroke="#000" stroke-width=".26458px">
          <path d="m0 40h3"/>
          <path d="m80 40h-3"/>
          <path d="m40 0v3"/>
          <path d="m40 80v-3"/>
        </g>
        <g transform="rotate(10 40 40)" fill="none" stroke="#000" stroke-width=".26458px">
          <path d="m0 40h3"/>
          <path d="m80 40h-3"/>
          <path d="m40 0v3"/>
          <path d="m40 80v-3"/>
        </g>
        <g transform="rotate(20 40 40)" fill="none" stroke="#000" stroke-width=".26458px">
          <path d="m0 40h3"/>
          <path d="m80 40h-3"/>
          <path d="m40 0v3"/>
          <path d="m40 80v-3"/>
        </g>
        <g transform="rotate(70 40 40)" fill="none" stroke="#000" stroke-width=".26458px">
          <path d="m0 40h3"/>
          <path d="m80 40h-3"/>
          <path d="m40 0v3"/>
          <path d="m40 80v-3"/>
        </g>
        <g transform="rotate(30 40 40)" fill="none" stroke="#000" stroke-width=".26458px">
          <path d="m0 40h3"/>
          <path d="m80 40h-3"/>
          <path d="m40 0v3"/>
          <path d="m40 80v-3"/>
        </g>
        <g transform="rotate(60 40 40)" fill="none" stroke="#000" stroke-width=".26458px">
          <path d="m0 40h3"/>
          <path d="m80 40h-3"/>
          <path d="m40 0v3"/>
          <path d="m40 80v-3"/>
        </g>
        <g transform="rotate(40 40 40)" fill="none" stroke="#000" stroke-width=".26458px">
          <path d="m0 40h3"/>
          <path d="m80 40h-3"/>
          <path d="m40 0v3"/>
          <path d="m40 80v-3"/>
        </g>
        <g transform="rotate(50 40 40)" fill="none" stroke="#000" stroke-width=".26458px">
          <path d="m0 40h3"/>
          <path d="m80 40h-3"/>
          <path d="m40 0v3"/>
          <path d="m40 80v-3"/>
        </g>
        <ellipse cx="40.062" cy="40.123" rx="33.805" ry="33.743" fill="none" stroke="#000" stroke-width=".323"/>
        <g fill="#000000" font-family="sans-serif">
          <text transform="scale(.98363 1.0166)" x="38.318161" y="5.6435556" font-size="5.0813px" stroke-width=".12703" style="line-height:1.25" xml:space="preserve"><tspan x="38.318161" y="5.6435556" font-weight="bold" stroke-width=".12703">N</tspan></text>
          <g font-size="5.0813px" stroke-width=".12703">
            <text transform="matrix(0 .98363 -1.0166 0 0 0)" x="38.889778" y="-73.207962" style="line-height:1.25" xml:space="preserve"><tspan x="38.889778" y="-73.207962" font-weight="bold" stroke-width=".12703">E</tspan></text>
            <text transform="scale(-.98363 -1.0166)" x="-42.412056" y="-73.273277" style="line-height:1.25" xml:space="preserve"><tspan x="-42.412056" y="-73.273277" font-weight="bold" stroke-width=".12703">S</tspan></text>
            <text transform="matrix(0 -.98363 1.0166 0 0 0)" x="-43.625999" y="5.5284638" style="line-height:1.25" xml:space="preserve"><tspan x="-43.625999" y="5.5284638" font-weight="bold" stroke-width=".12703">W</tspan></text>
          </g>
          <text transform="matrix(.95131 .34625 -.33784 .92821 0 0)" x="48.03627" y="-10.358718" font-size="4.2015px" stroke-width=".10504" style="line-height:1.25" xml:space="preserve"><tspan x="48.03627" y="-10.358718" stroke-width=".10504">20</tspan></text>
          <g font-size="4.2015px" stroke-width=".10504">
            <text transform="matrix(.77552 .65074 -.63494 .75669 0 0)" x="53.085007" y="-29.664335" style="line-height:1.25" xml:space="preserve"><tspan x="53.085007" y="-29.664335" stroke-width=".10504">40</tspan></text>
            <text transform="matrix(.50618 .87673 -.85545 .49389 0 0)" x="51.518383" y="-49.638081" style="line-height:1.25" xml:space="preserve"><tspan x="51.518383" y="-49.638081" stroke-width=".10504">60</tspan></text>
            <text transform="matrix(.1758 .99699 -.97278 .17153 0 0)" x="43.260281" y="-67.808342" style="line-height:1.25" xml:space="preserve"><tspan x="43.260281" y="-67.808342" stroke-width=".10504">80</tspan></text>
            <text transform="matrix(-.1758 .99699 -.97278 -.17153 0 0)" x="28.069746" y="-81.832481" style="line-height:1.25" xml:space="preserve"><tspan x="28.069746" y="-81.832481" stroke-width=".10504">100</tspan></text>
            <text transform="matrix(-.50618 .87673 -.85545 -.49389 0 0)" x="10.368654" y="-90.363251" style="line-height:1.25" xml:space="preserve"><tspan x="10.368654" y="-90.363251" stroke-width=".10504">120</tspan></text>
            <text transform="matrix(-.77552 .65074 -.63494 -.75669 0 0)" x="-9.3716278" y="-92.047745" style="line-height:1.25" xml:space="preserve"><tspan x="-9.3716278" y="-92.047745" stroke-width=".10504">140</tspan></text>
            <text transform="matrix(-.95131 .34625 -.33784 -.92821 0 0)" x="-27.592531" y="-86.820335" style="line-height:1.25" xml:space="preserve"><tspan x="-27.592531" y="-86.820335" stroke-width=".10504">160</tspan></text>
            <text transform="matrix(-.95131 -.34625 .33784 -.92821 0 0)" x="-54.736382" y="-59.185238" style="line-height:1.25" xml:space="preserve"><tspan x="-54.736382" y="-59.185238" stroke-width=".10504">200</tspan></text>
            <text transform="matrix(-.77552 -.65074 .63494 -.75669 0 0)" x="-59.544521" y="-39.940136" style="line-height:1.25" xml:space="preserve"><tspan x="-59.544521" y="-39.940136" stroke-width=".10504">220</tspan></text>
            <text transform="matrix(-.50618 -.87673 .85545 -.49389 0 0)" x="-58.454197" y="-20.134676" style="line-height:1.25" xml:space="preserve"><tspan x="-58.454197" y="-20.134676" stroke-width=".10504">240</tspan></text>
            <text transform="matrix(-.1758 -.99699 .97278 -.17153 0 0)" x="-49.920563" y="-2.068289" style="line-height:1.25" xml:space="preserve"><tspan x="-49.920563" y="-2.068289" stroke-width=".10504">260</tspan></text>
            <text transform="matrix(.1758 -.99699 .97278 .17153 0 0)" x="-36.010082" y="11.998429" style="line-height:1.25" xml:space="preserve"><tspan x="-36.010082" y="11.998429" stroke-width=".10504">280</tspan></text>
            <text transform="matrix(.50618 -.87673 .85545 .49389 0 0)" x="-18.508804" y="20.492743" style="line-height:1.25" xml:space="preserve"><tspan x="-18.508804" y="20.492743" stroke-width=".10504">300</tspan></text>
            <text transform="matrix(.77552 -.65074 .63494 .75669 0 0)" x="0.91190743" y="22.373159" style="line-height:1.25" xml:space="preserve"><tspan x="0.91190743" y="22.373159" stroke-width=".10504">320</tspan></text>
            <text transform="matrix(.95131 -.34625 .33784 .92821 0 0)" x="19.448372" y="17.080835" style="line-height:1.25" xml:space="preserve"><tspan x="19.448372" y="17.080835" stroke-width=".10504">340</tspan></text>
          </g>
        </g>
        <g transform="matrix(1 0 0 1.2105 0 -1.3684)" fill="none" stroke="#f00">
          <path d="m40 6.5 9 9.5" stroke-width=".565"/>
          <path d="m40 6.5-9 9.5" stroke-width=".565"/>
        </g>
        <g fill="none">
          <g stroke-width=".565">
            <path d="m36 12v28" stroke="#f00"/>
            <path d="m44 12v28" stroke="#f00"/>
            <path d="m36 40v33.5" stroke="#000"/>
            <path d="m44 40v33.5" stroke="#000"/>
          </g>
          <g stroke="#f00">
            <path d="m36 17 4-5 4 5" stroke-width=".565"/>
            <path d="m36 20.5 4-5 4 5" stroke-width=".565"/>
            <path d="m36 24 4-5 4 5" stroke-width=".565"/>
          </g>
        </g>
      </g>
    </svg>
    <!-- NOTE: Manually correct viewBox to match above -->
    <svg id="needle" version="1.1" viewBox="0 0 80.465 80.465" xmlns="http://www.w3.org/2000/svg" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
      <metadata>
        <rdf:RDF>
          <cc:Work rdf:about="">
            <dc:format>image/svg+xml</dc:format>
            <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/>
            <dc:title/>
          </cc:Work>
        </rdf:RDF>
      </metadata>
      <g>
        <g stroke="#000">
          <ellipse cx="40.132" cy="40.115" rx="5.867" ry="5.8375" fill="#f00" stroke-width=".26997"/>
          <path d="m42.132 34.632v-23.5l-2-4.5-2 4.5v23.5" fill="#f00" stroke-width=".26458px"/>
          <path d="m42.132 45.632v23.5l-2 4.5-2-4.5v-23.5" fill="#fff" stroke-width=".26458px"/>
          <ellipse cx="40.122" cy="40.144" rx="3.9086" ry="3.8869" stroke-width=".20658"/>
        </g>
        <rect x="38.632" y="17.132" width="3" height="7" fill="#fff"/>
        <text transform="scale(.91698 1.0905)" x="41.707207" y="14.292045" fill="#ffffff" font-family="sans-serif" font-size="4.8923px" stroke-width=".12231" style="line-height:1.25" xml:space="preserve"><tspan x="41.707207" y="14.292045" fill="#ffffff" font-weight="bold" stroke-width=".12231">N</tspan></text>
      </g>
    </svg>
  </div>
  
  <script type="text/javascript">
    var disp   = document.getElementById('disp');
    var needle = document.getElementById('needle');

    if (window.DeviceMotionEvent) {
      window.addEventListener('deviceorientation', function(event) {
        if (event.alpha) {
          disp.innerHTML = "Alpha: " + event.alpha;
          var rotation = 360 - event.alpha;
          needle.style.transform = "rotate("+rotation+"deg)";
        } else {
          disp.innerHTML = "Alpha is undefined ";
        }
      });
    }
  </script>

</body>
